# Automatically generated on 2021-03-12 UTC from https://codemagic.io/app/604564acbe2f9fb72766d730/settings
# Note that this configuration is not an exact match to UI settings. Review and adjust as necessary.

workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      flutter: v2.0.1
      # xcode: latest
      # cocoapods: default
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmdTOG51YTFlcVBsRVYxZldFQzJFc3RUV3ktUkdnameQZ1ZsZmMtSGlUZDh1eFA5dDZtMDNQVjc5WVViT0dsaW5ZNXhEY1B4eGdVekZPdzFUN0MwQkY4T3V6QjVoQWdCekJoZWxncXhoeVBTQmU2akV1MWJQT2dYQzdsMzBCSTJTUUR5cjJrSG91RjBjRl8xR0RiNVAwZTNLc2VZam9DRXZEamdmVXdUWV82ckxMTkE0R00yOUhxWGxrM21STEVJeXo2MXQ3TGFlYzRLd1RQR3NIRWVFd0tZSl9oN0dRRy00Snp2QldQc3NvY0tEX2M3NEZhR0xPc1lqTHcwenRYSGQ2M2RqN0pRbjBVakMtVzVndEljd3hMcW1mYWZ4QVZPd1BSSHNkalZCa2cyTVhEVmhyUDNDb0NBaWFZZzRJTmM0Um1fSlZNVEMxX3dBNEJWQ2pUS1VmX3JDbDNIN0hPdFR4YTU3UEVIdUt0MV90dnh1a2dDVjBYbng1NFJsaW1WaVJUVXZKVFhZb1BOcWxld0dHdGtWX1o0b1U5Zkh6Z0FodlVhMVVCX0E5bVJYWjV6RXYwb05QRFcxN3kyeUhWUi12R0hLOGgzQUNDTU4wNXVPYkFXOGNPUW9hRnRNcFN1aVh5UHFSbkN4cFNBYVd5VWkySXdlZ2ZGWWY2TlNlUnVCYjJlTF9RdWYxZ1RuanRSeFB4RlVkVmFaY21YbU4wME9qYXhMcmJLZXlvODFZeFJTaVFWYlp3c0lJWU1uSGI4b0wxTklmczBYWHgxZl9FNld3a0pocXkzeDBIS3BfUjVqWGNBSlN2el9yamVRQkliRGxURWFjZDhFWThxRDcycVVyU215VzI5MzJDdjJ5M09KdjE0SmlGdkU3Wi1uQzZMam9tT3JNMnJRTVc4ZGZRZmI4NFlJTC1LdW9nYzlsXzNNbDY3NDNFc05UWEt4d25HQVhoYzNuWHk4eVpzWGNfQzZlcE1pb3J0S0xlWUFtb0xXS1JPSllQWEQ5Y19nVlJ6Nmg2Z3UwNUt4ZmpMZG56NjNpSnpSNEJlMkwydDNCQlBicUxHNWJWZjMwcGY1TGhkNUltMmVQS2E2c3ppaG4wb3lsX2J6WlFYdUJoa21TV3pRLWZuYUFXenpsbUF6LTZYZ1RBLVhwYk1MOHJpREZzazgtOFBYYWRsSW1ObTVNVHVwSHBhaENqR0RLelAyRXhVNUkyZk9hRUl5Sk9sVy12Zk5NRlVjYks0ZXZ3YzNtVlloTnVtUDBfY1BUQXVfS1ZFbk1pYzRxMkFGV0RDYWtmRTJqYnZJdm5tVkJ3dk00SVFKa0JMNjVwYnVIOGg1eDE3a0NQNFkwUEVRUnFTeWoxYUQzSjRvYUVlcUlCclNuLS1mbEFpVEc1eGx4QnZYLTJ3Qmx2TThXSE1NYUxaVEZwVzg0cDktZUVmMGNvZTVlM3JIZW1mUU9xYVNZekhaSk4zRzZ4cnFfX1VkQm9UYUlaaHJoRlpiMnVhdlhLckxxczY2Qy1nekFPczlSYzlYLXNTV25XZFFmZ19oTzNHUEJjNkJLNVhBSEdUcm9XdDBPRDJJd1JDUHloVV9wNlFOQkxGRGdnZGpjLVVsTGh3Z3pHVmlVQl9KRDV0Zm0zWjJBUTJGbUlTbkhRNHVZOFBQR3IxWW9wV2lfSnRkaHMydlRYVGVpVzhzcTI1UkdfOG1nZWdOV09kUEY2dUpFQTMybkhhR3V0am1QR0g0ckFqYV9mUDRmc1lZeWt1X3RxQVppV19LZkN5bjE5Rm5rTGY1c0hfSS1FSnFUQzVnZ2gzeWJ6SXF5RkFKX1pNU3FiQjEtbVpXbFByb2pDeTBTWW4zSDZudFVfYkduQW0yWVlyUFBzQkRSR2xPYk5uWklRZUEtb2dWTWxaTkdBVnZnRzREWXZ5QWVvYzhRUWowSXJONlhxcFg5QXJ5OVE2OUxrVWRHQmxrNFNtMlBXY2pZZmxVelp1cktzZ1NCbVVZMlFaUUtCa0ZGVFBwV2s0WmJnM2w3YldMaEtQWmNscU1mbFFGN1Q4YmJDNEFOU3lTYy1JOTN3YXN1Y0FxakNfSkFaUEZoUGV2ZmtkWlZTZFB6ZHBZV1BzR3ZCMlduZnQyS1ZsbGVnVk5ucFk1V0lRc1owQ0N3ekZsclNySXJoVzhSVWxOc0FSSU1DMWZsWi1lMkdnRHBHMUo5THA5WU90R0RTNTFjaHhIYlA2VVJHbm9raW9VaW5qYUxtLWJUQnhhN01rMWhLVzFLRmVYbUlMTjFsQUlINThSRGpiU1kzdXNZZTkyMTBFdkpTN2NobDBMdUVOM1R1NlJyV2tYTGl0SFlfajlhVjZ6ZUhUdXVNMTQwdWltN21TaHc0YVY1VFZYSHB3Snl4dWVwQWVrd0dBUng2UkN1aE5hZ1NWU3BQWW4zbHRiMlJjazVQc0VqOHF0bl9lM3g1bWJUWkFaOXN2dUFoTDRoaWJ2d0xRRFZtLUJoS1duTmJYbmNhdFJXQXc3VkZ0YWJVbnVnLXdwa0JkTnpPSWhLa3otekxxUTdkWHFIeGJjZVJoUXBwamJ2ZXNxOUlXQ01XZWlqa25zOTM5U3YwTzJLOTlVdklNUWhYSGtCU0FHckc2TE96WWFhTFhld2dZWVdpemt2WjQ2TnBmZUh0bmRnS3FnLVVSUnR0X3ppemM4VjdjYWhwcnY3RDVwdERQaEhnWVVYcThUaS1TeElESTdDOG02RE16a3p1Vm1Jc2hlbFJjTDV4NWpNaXRfX1NfcWEtYzNpMnUyOTFNS1FlSm9COThSLWNHZ1lzZzhtOU83eVhHbmstVEZlcnFLR1pkdGV6ZUh0dVVSa1pLSFlkYjhJd1dMN2RqWDBsNGhXNUlEbG01YXlrclpKU0ZnMG4weGVkT2hKSUxTUDA4T2luQlMxbzZKUFBPYzJJU19nRTVWSEpNWXU2YVFBbzB3NGRWX2dtN045V01peG5xQ0J1bzZtanY2cVk2VlhFYm1XdmFTWGVwQnlRQWJ1V0tBUGphYkppSWJ5X0UyNmRYSXFqNGx2c1hCeWZrdEdzVkNzSkZXN2NNTmZiYmN4WVhEUFZHUURZTG11VFBGNUhQYjNMV3Q0THh2bi1zcUE2TDlVa25ickFua3pGSTM0T096SmRZOXZjdFJIRkI4ZWhKVk5GMENDanhRaHo2dFRrMTRGNnJUSUpmc3A4M2ZHVC0zYjhma0EwV2lVbWoxTkFJNlpJeWQtUml3akxSQ051aTF6N1lTTkF5LUNVamI0VGVCNkxURHdUVHFzUFl6TFJQalJWdlNpMGRxdXdyejNJWUtjOE9pdGo0SEpXZnlYVzdZeGdtVFVFUDQ4ZWhyZXNtWHV5YXQxNi1KTEUxc3VsUkZseU0xVVZzLVMxS2hRNVNYWnNxcFhVdmZpU1dhRDNtUzRSZFRBVWRpeWt5YVV2b3l0QVBFRTBERG1oYVhOWUduTDBTeW83NnBRVzhuMVpKS1hTVzFqcnJnQW9yYjh2NDNQM0JVZms5SmNMMVhhU0JZVXo2MlpzSkRTZVh1LW5WcGs0eUJubGVNV0NoZHk1bm83TmRiSGNfMnU4Z3ZCTnd0dDNCc0xoZ2pMVXNJV2VVbkpJWTdtLW9kRWRGeGhGeHR6RkhKSFo0UjRRY002SEdwaEFIQWJWTFN1TFJQcTdLa2Vqcm5aY19HNGl4WjRGWFZQaGl3aEtySEMtcE5oVlpid1JHNzJuZUk4QlFQRGtqeDNRQmZhVTE2cFVwaWFCZ2ZvXzRHQnpsSUVNU1FHckxydzRKUG5HVDhjRGU1SkRuYWJEeC1wejJpby1tX04tWnJDa1N0SUEwOURZY3ZQMkhENW5KeHlvUkVQUjN3SUNROHpWaGw5c2s3MURNYXhBX3ZkTzlEaEFQTHUyVjNUYzl0ZEFOcGRLdDNDWDlza1hBQnU2cEhabTlBRUVsNU8wVlBIbGpzOW5nTDhfdnQ2Q3pBN0VLZFRzeVpBN2g1SFZlbEpCVXdCOTg0ZURkUzhROVl3cjBrTExIU1FVaXZ6Q3ZJN3o1bHVBOWY1bU9JUUZScWMzZUc0ZE5ubmZMdnN2Yi1Qb1U2ZTFEQWJ5Q21wSWZvNDE0b2pYZTZPOHNGdnQ3cm8xb1BkaXl2SzlvcUY5dVRrVFVCTjNlMDFMTDdsS3A0czBzUVBzYXpPNHN4YmNmWV9jSGlvdkJpUTJoODhkX2NfR0dUdkFZTVpDc0xXU3VFcHRSQ09OamNTTVJBTjU5blRoOUVmTk02VmlsS1FSSWc2cHFPVWlJZFlGVVdLQVlNTldSeGlEQ2FZVjFocnZOX1h0V2FUQkN6el8tcVRzdURia1M3RE9NWVZ6TDN2OTlDWVNaSFVDcGpCTFZveThCZEZvUksxbGpzRWV6UmpLckxyNGVmT3JxTmVmblAwSzZndVVqNE9DNEw4MUhTdmR3bXFWVGh1cEdyVzluSjNtZWtFclVaNGo0ckZKUWs1V0VuaFUtcmQyb0w5QVZRSkxoa0N1SWZSYnpIWFE1MXNTN29Oc1lKOXJ0eEJuM2hOV2ZaQzhISVlwZTZ2QVhVT2FTaDRCQkIwZHJMcV9vaUN3NzZwSk5PanB2SERaRXdpbExWajZySWEtbmlKVV8wUGVodnNOcDVveFZ4Q0Y2UDY3RVdXcU91NGRPcHEtdTlSMlJGNG9sZlVYb0lCYlpXbXdBREtQTDlxeW1CbUM4WWZfVWxvSnc4X2xaSWV4bXJwdHBkdGRCc3AzeGlxOVhjSEpKQmZoM3VpdXBYZGxfTnR5cG9wbExjMUdGV04zcEIzM0g1bE5rZHRoa2xjRmFRWi0yWm5SVHZTeWNaTHpIdTBCQzFjbklkM3FiWVNDR09qc2hQeVQ2V3J6dEJqZndjUkpYcUlpWlN2cmZYNjJZY19zT29zZEYwY1o3VzAwRUp5aWdzU1pBWklBN3dBcmhIRzNXRlQzdEFQSVZ6WW13ZnZJQ09XeFVyWmt1NHh6dmRYOC1aMmU2VlBQalFnNFRXdzhwUHN0Mjc2VW5heEt0cUs2RXhxOXoxQ0s3TTNJVE0yUmw2Tk5kWGtmZlhQUzA5U3BUVGc2REluTzVDQ0l2NHN2V2lpWG5oLUJtMkl2VmpTTnlFbjZZUy04WWZzQjhtbzNxWDVZWW5NaVFxSXktWW1iTXJXdDhvdXFfYTliMTB1eVlCdEVESDBTdWQtaUo0NUc5NnVhalB5WDBXbWFBV3BUdHNobHhZVzBzay10OWRtWWdobTdIcWZEeU5EQjlJbm9tbjBJM1U0Rzd6V0EyNjlPbTN2YzFTQ04xQmNfcHRuMzBHd2JEZEZBcHI0dXk5WVRJSDdZQy1Dem9uUHdhalZxNEQ0b0xMREZjYXhlN0xQLVdu)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdTOG9fWk5uUjB3c1lyelc2Z0dhSFlkaWx4U05GU29yWnNqd3ptTjVyLVdJcEJuZ0d2bXVjUWY1eHBDNTRZRkJNNUVJYm93a3hROG45eGFQRmFmVnA3Ym5RR2c9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmdTOG9fWk5uUjB3c1lyelc2Z0dhSFlkaWx4U05GU29yWnNqd3ptTjVyLVdJcEJuZ0d2bXVjUWY1eHBDNTRZRkJNNUVJYm93a3hROG45eGFQRmFmVnA3Ym5RR2c9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmdTOHB0ekR2dGh1cFRScW93d21yU0RlRS1aTk55QTd0eWNzNWU2TmtoU2E4VTdVenlmeUFPbnJOUjd1d3dPbldybUI0MXAyU3N4YnZfZngtVkRqRzhCNHBhS1E9PQ==)
    scripts:
      - name: Set up key.properties
        script: |
          echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
          cat >> "$FCI_BUILD_DIR/project_directory/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=$FCI_KEYSTORE_PATH
          EOF
      - name: Set up local.properties
        script: echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"

      # Build binaries
      - cd . && flutter packages pub get
      - cd . && flutter build apk --release --split-per-abi
      - cd . && flutter build apk --release

      - name: generate sha256sum per-file
        script: |
        mkdir sha256_sums
        for file in app-{,arm64-v8a-,armeabi-v7a-,x86_64-}release.apk; do sha256sum build/app/outputs/flutter-apk/$file | awk '{ print $1 }' > sha256_sums/sha256-$file.txt; done
    artifacts:
      - build/app/outputs/flutter-apk/app-release.apk
      - build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
      - build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk
      - build/app/outputs/flutter-apk/app-x86_64-release.apk
      - sha256_sums/sha256-app-release.apk.txt
      - sha256_sums/sha256-app-arm64-v8a-release.apk.txt
      - sha256_sums/sha256-app-armeabi-v7a-release.apk.txt
      - sha256_sums/sha256-app-x86_64-release.apk.txt
      # - build/**/outputs/**/*.aab
      # - build/**/outputs/**/mapping.txt
      # - flutter_drive.log
    publishing:
      email:
        recipients:
          - admin@pato05mc.tk
